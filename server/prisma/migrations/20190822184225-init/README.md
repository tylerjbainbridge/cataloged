# Migration `20190822184225-init`

This migration has been generated by Tyler Bainbridge at 8/22/2019, 6:42:25 PM.
You can check out the [state of the datamodel](./datamodel.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User"("id" text NOT NULL  ,"email" text NOT NULL DEFAULT '' ,"firstName" text   ,"lastName" text   ,PRIMARY KEY ("id"))
;

CREATE TABLE "public"."Label"("id" text NOT NULL  ,"createdAt" timestamp(3) NOT NULL  ,"updatedAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,"name" text NOT NULL DEFAULT '' ,PRIMARY KEY ("id"))
;

CREATE TABLE "public"."Item"("id" text NOT NULL  ,"createdAt" timestamp(3) NOT NULL  ,"updatedAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,"type" text NOT NULL DEFAULT '' ,PRIMARY KEY ("id"))
;

CREATE TABLE "public"."Link"("id" text NOT NULL  ,"createdAt" timestamp(3) NOT NULL  ,"updatedAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,"href" text NOT NULL DEFAULT '' ,"notes" text NOT NULL DEFAULT '' ,PRIMARY KEY ("id"))
;

CREATE TABLE "public"."File"("id" text NOT NULL  ,"createdAt" timestamp(3) NOT NULL  ,"updatedAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,"name" text NOT NULL DEFAULT '' ,"extension" text NOT NULL DEFAULT '' ,"size" text   ,"width" integer   ,"height" integer   ,"isUploaded" boolean NOT NULL DEFAULT false ,PRIMARY KEY ("id"))
;

CREATE TABLE "public"."UploadGroup"("id" text NOT NULL  ,"createdAt" timestamp(3) NOT NULL  ,"updatedAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,"isComplete" boolean NOT NULL DEFAULT false ,PRIMARY KEY ("id"))
;

CREATE TABLE "public"."GoogleAccount"("id" text NOT NULL  ,"createdAt" timestamp(3) NOT NULL  ,"updatedAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,"accountId" text   ,"email" text   ,"firstName" text   ,"lastName" text   ,"picture" text   ,"refreshToken" text   ,PRIMARY KEY ("id"))
;

CREATE TABLE "public"."_ItemToLabel"("A" text   REFERENCES "public"."Item"("id") ON DELETE CASCADE,"B" text   REFERENCES "public"."Label"("id") ON DELETE CASCADE)
;

ALTER TABLE "public"."Label" ADD COLUMN "user" text   REFERENCES "public"."User"("id") ON DELETE SET NULL;

ALTER TABLE "public"."Item" ADD COLUMN "user" text   REFERENCES "public"."User"("id") ON DELETE SET NULL,ADD COLUMN "link" text   REFERENCES "public"."Link"("id") ON DELETE SET NULL;

ALTER TABLE "public"."Link" ADD COLUMN "user" text   REFERENCES "public"."User"("id") ON DELETE SET NULL;

ALTER TABLE "public"."File" ADD COLUMN "user" text   REFERENCES "public"."User"("id") ON DELETE SET NULL,ADD COLUMN "item" text   REFERENCES "public"."Item"("id") ON DELETE SET NULL,ADD COLUMN "uploadGroup" text   REFERENCES "public"."UploadGroup"("id") ON DELETE SET NULL;

ALTER TABLE "public"."UploadGroup" ADD COLUMN "user" text   REFERENCES "public"."User"("id") ON DELETE SET NULL;

ALTER TABLE "public"."GoogleAccount" ADD COLUMN "user" text   REFERENCES "public"."User"("id") ON DELETE SET NULL;

CREATE UNIQUE INDEX "User.id._UNIQUE" ON "public"."User"("id")

CREATE UNIQUE INDEX "User.email._UNIQUE" ON "public"."User"("email")

CREATE UNIQUE INDEX "Label.id._UNIQUE" ON "public"."Label"("id")

CREATE UNIQUE INDEX "Item.id._UNIQUE" ON "public"."Item"("id")

CREATE UNIQUE INDEX "Link.id._UNIQUE" ON "public"."Link"("id")

CREATE UNIQUE INDEX "File.id._UNIQUE" ON "public"."File"("id")

CREATE UNIQUE INDEX "UploadGroup.id._UNIQUE" ON "public"."UploadGroup"("id")

CREATE UNIQUE INDEX "GoogleAccount.id._UNIQUE" ON "public"."GoogleAccount"("id")

CREATE UNIQUE INDEX "GoogleAccount.accountId._UNIQUE" ON "public"."GoogleAccount"("accountId")
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20190822184225-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,108 @@
+datasource db {
+  provider = "postgres"
+  url      = env("POSTGRESQL_URL")
+  default  = true
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+generator nexus_prisma {
+  provider = "nexus-prisma"
+}
+
+model User {
+  id        String  @default(cuid()) @id @unique
+  email     String  @unique
+  firstName String?
+  lastName  String?
+
+  items          Item[]
+  files          File[]
+  googleAccounts GoogleAccount[]
+}
+
+model Label {
+  id        String   @default(cuid()) @id @unique
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  name String
+
+  user  User
+  items Item[]
+}
+
+model Item {
+  id        String   @default(cuid()) @id @unique
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  type String
+
+  file File?
+  link Link?
+
+  labels Label[]
+}
+
+
+model Link {
+  id        String   @default(cuid()) @id @unique
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  href String
+
+  notes String
+
+  item Item
+  user User
+}
+
+model File {
+  id        String   @default(cuid()) @id @unique
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  name      String
+  extension String
+  size      String?
+
+  width  Int?
+  height Int?
+
+  isUploaded Boolean
+
+  item        Item
+  user        User
+  uploadGroup UploadGroup
+}
+
+model UploadGroup {
+  id        String   @default(cuid()) @id @unique
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  isComplete Boolean
+
+  user  User
+  files File[]
+}
+
+model GoogleAccount {
+  id String @default(cuid()) @id @unique
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  accountId    String? @unique
+  email        String?
+  firstName    String?
+  lastName     String?
+  picture      String?
+  refreshToken String?
+
+  user User
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20190822184225-init)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20190822184225-init'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
