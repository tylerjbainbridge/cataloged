# Migration `20200210215724-add-titles-to-nots`

This migration has been generated by Tyler Bainbridge at 2/10/2020, 9:57:24 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Collection" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "person" text  NOT NULL ,
    "type" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "user" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Person" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "user" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."Item" ADD COLUMN "collection" text   ,
ADD COLUMN "person" text   ;

ALTER TABLE "public"."Note" ADD COLUMN "title" text   DEFAULT '';

ALTER TABLE "public"."Collection" ADD FOREIGN KEY ("person") REFERENCES "public"."Person"("id") ON DELETE RESTRICT

ALTER TABLE "public"."Collection" ADD FOREIGN KEY ("user") REFERENCES "public"."User"("id") ON DELETE RESTRICT

ALTER TABLE "public"."Person" ADD FOREIGN KEY ("user") REFERENCES "public"."User"("id") ON DELETE RESTRICT

ALTER TABLE "public"."Item" ADD FOREIGN KEY ("collection") REFERENCES "public"."Collection"("id") ON DELETE SET NULL

ALTER TABLE "public"."Item" ADD FOREIGN KEY ("person") REFERENCES "public"."Person"("id") ON DELETE SET NULL
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200202121544-add-values-column..20200210215724-add-titles-to-nots
--- datamodel.dml
+++ datamodel.dml
@@ -1,11 +1,11 @@
-generator photon {
+generator prisma {
   provider = "prisma-client-js"
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRESQL_URL")
 }
 model InviteCode {
   id String @id @default(cuid())
@@ -27,41 +27,43 @@
   updatedAt DateTime @updatedAt
 }
 model File {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
   extension           String   @default("")
   hasStartedUploading Boolean?
   height              Int?
-  id                  String   @id @default(cuid())
-  isFailed            Boolean?
-  isUploaded          Boolean?
-  item                Item
-  name                String   @default("")
-  size                String?
+  isFailed   Boolean?
+  isUploaded Boolean?
+  item       Item
+  name       String   @default("")
+  size       String?
+
   title       String @default("")
   description String @default("")
   uploadGroup UploadGroup
   user        User
   width       Int?
+}
+model GoogleAccount {
+  id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
-}
-model GoogleAccount {
   accountId    String? @unique
   email        String?
   firstName    String?
-  id           String  @id @default(cuid())
   lastName     String?
   picture      String?
   refreshToken String?
-  user         User
-  createdAt DateTime @default(now())
-  updatedAt DateTime @updatedAt
+  user User
 }
 model SavedSearch {
   id        String   @id @default(cuid())
@@ -91,70 +93,109 @@
   savedSearch SavedSearch?
 }
 model Item {
-  id          String   @id @default(cuid())
-  isFavorited Boolean  @default(false)
-  status      String?  @default("NOT_STARTED")
-  link        Link?
-  note        Note?
-  type        String   @default("")
-  user        User?
-  file        File?
-  labels      Label[]
-  createdAt   DateTime @default(now())
-  updatedAt   DateTime @updatedAt
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  isFavorited Boolean @default(false)
+  status      String? @default("NOT_STARTED")
+  type        String  @default("")
+
+  link   Link?
+  note   Note?
+  user   User?
+  file   File?
+  labels Label[]
 }
 model Label {
   id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
-  name  String @default("")
+  name String @default("")
+
   user  User
   items Item[]
 }
+
+
 model Link {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
   description String?
   favicon     String?
   href        String  @default("")
-  id          String  @id @default(cuid())
   image       String?
   notes       String  @default("")
   title       String?
-  user        User
-  item        Item?
-  createdAt DateTime @default(now())
-  updatedAt DateTime @updatedAt
+  user User
+  item Item?
 }
 model Note {
   id        String   @id @default(cuid())
-  raw       String   @default("")
-  text      String   @default("")
-  user      User
-  item      Item?
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
+
+  title String? @default("")
+
+  raw  String @default("")
+  text String @default("")
+
+  user User
+  item Item?
+
 }
 model UploadGroup {
-  id         String   @id @default(cuid())
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
   isComplete Boolean?
   isFailed   Boolean?
   user       User
   files      File[]
-  createdAt  DateTime @default(now())
-  updatedAt  DateTime @updatedAt
 }
+model Collection {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  type String @default(now())
+
+  person Person
+
+  user User
+
+  items Item[]
+}
+
+model Person {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  name  String @default("")
+  user  User
+  items Item[]
+}
+
 model User {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
   email          String          @default("") @unique
   firstName      String?
-  id             String          @id @default(cuid())
   lastName       String?
   files          File[]
   googleAccounts GoogleAccount[]
   items          Item[]
@@ -167,7 +208,6 @@
   isActive Boolean @default(false)
   inviteCode InviteCode?
-  createdAt DateTime @default(now())
-  updatedAt DateTime @updatedAt
+
 }
```


