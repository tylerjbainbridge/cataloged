# Migration `20200202114038-add-saved-search`

This migration has been generated by Tyler Bainbridge at 2/2/2020, 11:40:39 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."SavedSearch" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "user" text   ,
    "version" integer  NOT NULL DEFAULT 0,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Filter" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "savedSearch" text   ,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "user" text   ,
    "value" text   ,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."SavedSearch" ADD FOREIGN KEY ("user") REFERENCES "public"."User"("id") ON DELETE SET NULL

ALTER TABLE "public"."Filter" ADD FOREIGN KEY ("savedSearch") REFERENCES "public"."SavedSearch"("id") ON DELETE SET NULL

ALTER TABLE "public"."Filter" ADD FOREIGN KEY ("user") REFERENCES "public"."User"("id") ON DELETE SET NULL
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200128162207-add-file-title..20200202114038-add-saved-search
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRESQL_URL")
 }
 model InviteCode {
   id String @id @default(cuid())
@@ -62,8 +62,33 @@
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
 }
+model SavedSearch {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  name    String
+  version Int
+
+  user User?
+
+  filters Filter[]
+}
+
+model Filter {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  value String?
+
+  user User?
+
+  savedSearch SavedSearch?
+}
+
 model Item {
   id          String   @id @default(cuid())
   isFavorited Boolean  @default(false)
   status      String?  @default("NOT_STARTED")
@@ -78,13 +103,14 @@
 }
 model Label {
   id        String   @id @default(cuid())
-  name      String   @default("")
-  user      User
-  items     Item[]
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
+
+  name  String @default("")
+  user  User
+  items Item[]
 }
 model Link {
   description String?
```


