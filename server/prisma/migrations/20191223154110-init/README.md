# Migration `20191223154110-init`

This migration has been generated by Tyler Bainbridge at 12/23/2019, 3:41:10 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User" (
  "email" text  NOT NULL DEFAULT '' ,
  "firstName" text    ,
  "id" text  NOT NULL  ,
  "lastName" text    ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Label" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Item" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" text  NOT NULL  ,
  "type" text  NOT NULL DEFAULT '' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Link" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "description" text    ,
  "favicon" text    ,
  "href" text  NOT NULL DEFAULT '' ,
  "id" text  NOT NULL  ,
  "image" text    ,
  "notes" text  NOT NULL DEFAULT '' ,
  "title" text    ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."Note" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" text  NOT NULL  ,
  "raw" text  NOT NULL DEFAULT '' ,
  "text" text  NOT NULL DEFAULT '' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."File" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "extension" text  NOT NULL DEFAULT '' ,
  "hasStartedUploading" boolean    ,
  "height" integer    ,
  "id" text  NOT NULL  ,
  "isFailed" boolean    ,
  "isUploaded" boolean    ,
  "name" text  NOT NULL DEFAULT '' ,
  "size" text    ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "width" integer    ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."UploadGroup" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" text  NOT NULL  ,
  "isComplete" boolean    ,
  "isFailed" boolean    ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."GoogleAccount" (
  "accountId" text    ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "email" text    ,
  "firstName" text    ,
  "id" text  NOT NULL  ,
  "lastName" text    ,
  "picture" text    ,
  "refreshToken" text    ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."_ItemToLabel" (
  "A" text  NOT NULL  REFERENCES "public"."Item"("id") ON DELETE CASCADE,
  "B" text  NOT NULL  REFERENCES "public"."Label"("id") ON DELETE CASCADE
);

ALTER TABLE "public"."Label" ADD COLUMN "user" text  NOT NULL  REFERENCES "public"."User"("id") ON DELETE RESTRICT;

ALTER TABLE "public"."Item" ADD COLUMN "link" text    REFERENCES "public"."Link"("id") ON DELETE SET NULL,
ADD COLUMN "note" text    REFERENCES "public"."Note"("id") ON DELETE SET NULL,
ADD COLUMN "user" text    REFERENCES "public"."User"("id") ON DELETE SET NULL;

ALTER TABLE "public"."Link" ADD COLUMN "user" text  NOT NULL  REFERENCES "public"."User"("id") ON DELETE RESTRICT;

ALTER TABLE "public"."Note" ADD COLUMN "user" text  NOT NULL  REFERENCES "public"."User"("id") ON DELETE RESTRICT;

ALTER TABLE "public"."File" ADD COLUMN "item" text  NOT NULL  REFERENCES "public"."Item"("id") ON DELETE RESTRICT,
ADD COLUMN "uploadGroup" text  NOT NULL  REFERENCES "public"."UploadGroup"("id") ON DELETE RESTRICT,
ADD COLUMN "user" text  NOT NULL  REFERENCES "public"."User"("id") ON DELETE RESTRICT;

ALTER TABLE "public"."UploadGroup" ADD COLUMN "user" text  NOT NULL  REFERENCES "public"."User"("id") ON DELETE RESTRICT;

ALTER TABLE "public"."GoogleAccount" ADD COLUMN "user" text  NOT NULL  REFERENCES "public"."User"("id") ON DELETE RESTRICT;

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "Item_link" ON "public"."Item"("link")

CREATE UNIQUE INDEX "Item_note" ON "public"."Item"("note")

CREATE UNIQUE INDEX "File_item" ON "public"."File"("item")

CREATE UNIQUE INDEX "GoogleAccount.accountId" ON "public"."GoogleAccount"("accountId")

CREATE UNIQUE INDEX "_ItemToLabel_AB_unique" ON "public"."_ItemToLabel"("A","B")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20191223154110-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,132 @@
+datasource db {
+  provider = "postgres"
+  url      = env("POSTGRESQL_URL")
+  default  = true
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+model User {
+  id        String  @default(cuid()) @id
+  email     String  @unique
+  firstName String?
+  lastName  String?
+
+  googleAccounts GoogleAccount[]
+  items          Item[]
+  labels         Label[]
+  files          File[]
+  links          Link[]
+  notes          Note[]
+
+  uploadGroups UploadGroup[]
+}
+
+model Label {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  name String
+
+  user  User
+  items Item[]
+}
+
+model Item {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  type String
+
+  file File?
+  link Link?
+  note Note?
+
+  labels Label[]
+}
+
+
+model Link {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  href String
+
+  // Meta
+  title       String?
+  description String?
+  image       String?
+  favicon     String?
+
+  notes String
+
+  item Item
+  user User
+}
+
+model Note {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  raw  String
+  text String
+
+  item Item
+  user User
+}
+
+model File {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  name      String
+  extension String
+  size      String?
+
+  width  Int?
+  height Int?
+
+
+  isUploaded          Boolean?
+  hasStartedUploading Boolean?
+  isFailed            Boolean?
+
+  item        Item
+  user        User
+  uploadGroup UploadGroup
+}
+
+model UploadGroup {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  isComplete Boolean?
+  isFailed   Boolean?
+
+  user  User
+  files File[]
+}
+
+model GoogleAccount {
+  id String @default(cuid()) @id
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  accountId    String? @unique
+  email        String?
+  firstName    String?
+  lastName     String?
+  picture      String?
+  refreshToken String?
+
+  user User
+}
```


