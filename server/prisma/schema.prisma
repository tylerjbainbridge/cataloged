datasource db {
  provider = "postgres"
  url      = env("POSTGRESQL_URL")
  default  = true
}

generator photon {
  provider = "photonjs"
}

model User {
  id        String  @default(cuid()) @id @unique
  email     String  @unique
  firstName String?
  lastName  String?

  googleAccounts GoogleAccount[]
  items          Item[]
  collections    Collection[]
  files          File[]
  links          Link[]
  uploadGroups   UploadGroup[]
}

model Collection {
  id        String   @default(cuid()) @id @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  name String

  user  User
  items Item[]
}

model Item {
  id        String   @default(cuid()) @id @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  type String

  file File?
  link Link?

  collections Collection[]
}


model Link {
  id        String   @default(cuid()) @id @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  href String

  // Meta
  title       String?
  description String?
  image       String?
  favicon     String?

  notes String

  item Item
  user User
}

model File {
  id        String   @default(cuid()) @id @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  name      String
  extension String
  size      String?

  width  Int?
  height Int?


  isUploaded Boolean?
  isFailed   Boolean?

  item        Item
  user        User
  uploadGroup UploadGroup
}

model UploadGroup {
  id        String   @default(cuid()) @id @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  isComplete Boolean?
  isFailed   Boolean?

  user  User
  files File[]
}

model GoogleAccount {
  id String @default(cuid()) @id @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  accountId    String? @unique
  email        String?
  firstName    String?
  lastName     String?
  picture      String?
  refreshToken String?

  user User
}