# Migration `20200305174425-add-content-type`

This migration has been generated by Tyler Bainbridge at 3/5/2020, 5:44:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."ShareLink" (
    "collection" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "isEnabled" boolean  NOT NULL DEFAULT true,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "user" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."File" ADD COLUMN "contentType" text   ;

ALTER TABLE "public"."Item" ADD COLUMN "shareLink" text   ;

ALTER TABLE "public"."ShareLink" ADD FOREIGN KEY ("user") REFERENCES "public"."User"("id") ON DELETE RESTRICT

ALTER TABLE "public"."ShareLink" ADD FOREIGN KEY ("collection") REFERENCES "public"."Collection"("id") ON DELETE SET NULL

ALTER TABLE "public"."Item" ADD FOREIGN KEY ("shareLink") REFERENCES "public"."ShareLink"("id") ON DELETE SET NULL
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200302170415-item-connected-to-collection..20200305174425-add-content-type
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRESQL_URL")
 }
 model InviteCode {
   id String @id @default(cuid())
@@ -35,13 +35,14 @@
   extension           String   @default("")
   hasStartedUploading Boolean?
   height              Int?
-  isFailed   Boolean?
-  isUploaded Boolean?
-  item       Item
-  name       String   @default("")
-  size       String?
+  isFailed    Boolean?
+  isUploaded  Boolean?
+  item        Item
+  name        String   @default("")
+  size        String?
+  contentType String?
   title       String @default("")
   description String @default("")
@@ -102,8 +103,22 @@
   @@index([name, email, companyName, companyTitle])
 }
+model ShareLink {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  user User
+
+  isEnabled Boolean @default(true)
+
+  // Types of data you can share
+  collection Collection?
+  item       Item[]
+}
+
 model SavedSearch {
   id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
@@ -214,10 +229,8 @@
   @@index([name])
 }
-
-
 model Link {
   id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
```


