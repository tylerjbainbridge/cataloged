(this.webpackJsonpundefined=this.webpackJsonpundefined||[]).push([[0],{235:function(e,t,n){e.exports=n(408)},408:function(e,t,n){"use strict";n.r(t);var a=n(26),r=n(0),c=n.n(r),i=n(78),l=n.n(i),o=n(70),u=n(227),s=n(226),d=n(230),m=n(39),f=n(59);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var b=n(225),p=n(60),g=n(12),h=n(48),E=n(21),O=n(1),v=n(37),j=n.n(v),k=n(19),w=n(20),x=n.n(w),y=n(212),C=n(9),I=n(203),S=n(202),L=n(46),A=n(421),M=n(52),R=n(414),$=function(e){var t=e.src,n=e.isReady,i=void 0===n||n,l=e.showSpinner,o=void 0===l||l,u=e.loadingContainerProps,s=e.placeholderIcon,d=void 0===s?"view-off":s,m=(e.fit,Object(L.a)(e,["src","isReady","showSpinner","loadingContainerProps","placeholderIcon","fit"])),f=Object(r.useState)(null),b=Object(O.a)(f,2),p=b[0],g=b[1],h=Object(r.useState)(!1),E=Object(O.a)(h,2),v=E[0],j=E[1],k=Object(r.useState)({width:0,height:0}),w=Object(O.a)(k,2),x=(w[0],w[1]);Object(r.useEffect)((function(){if(i){var e=new Image;e.src=t,e.onload=function(){return g(e.src)},e.onerror=function(){return j(!0)},x({width:e.width,height:e.height})}}),[i]);var y=Object(a.a)({rounded:"lg"},m);return!i||!p||!t||v?c.a.createElement(C.a,Object.assign({d:"flex",justifyContent:"center",alignItems:"center",rounded:"lg",backgroundColor:"lightGrey"},y,u),t&&o?c.a.createElement(I.a,{size:"xl"}):c.a.createElement(M.a,{size:"50px",name:v?"warning":d})):c.a.createElement(R.a,Object.assign({src:t},y))},_=function(e){var t=Object(r.useRef)(Object(v.debounce)((function(){e.onSingleClick&&e.onSingleClick()}),200)),n=!!(e.onSingleClick||e.onDoubleClick||e.onMetaClick||e.onShiftClick);return e.children(Object(a.a)({},n?{cursor:"pointer"}:{},{onClick:function(n){e.onMetaClick&&n.metaKey?e.onMetaClick():e.onShiftClick&&n.shiftKey?e.onShiftClick():t.current()},onDoubleClick:function(){t.current.cancel(),e.onDoubleClick&&e.onDoubleClick()}}))},F=c.a.createContext({}),D=function(e){var t=e.children,n=e.items,a=e.initialSelectedMap,i=void 0===a?new Map:a,l=e.getId,o=void 0===l?function(e){return e.id}:l,u=Object(r.useState)(i),s=Object(O.a)(u,2),d=s[0],m=s[1],f=function(e){return m(new Map(e.entries()))},b=function(e){var t=o(e);return d.has(t)},p=function(e){var t=o(e);d.set(t,e),f(d)},g=function(e){var t=o(e);d.delete(t),f(d)},h=function(e){b(e)?g(e):p(e)};return c.a.createElement(F.Provider,{value:{selectedMap:d,isItemSelected:b,selectItem:p,deselectItem:g,toggleItem:h,onToggleThunk:function(e){return function(){return h(e)}},onSelectRangeThunk:function(e){return function(){return function(e){if(n){var t=Array.from(d.values())[d.size-1],a=n.findIndex((function(e){return o(e)===o(t)})),r=n.findIndex((function(t){return o(t)===o(e)})),c=a>r?[r,a]:[a,r],i=Object(O.a)(c,2),l=i[0],u=i[1];[e].concat(Object(E.a)(n.slice(l,u))).forEach((function(e){var t=o(e);d.set(t,e)})),f(d)}}(e)}},onResetAndSelectThunk:function(e){return function(){return b(e)?f(new Map):function(e){var t=new Map,n=o(e);t.set(n,e),f(t)}(e)}}}},t)},T=function(e){var t=e.item,n=e.children,a=Object(L.a)(e,["item","children"]),i=Object(r.useContext)(F),l=i.onToggleThunk,o=i.onSelectRangeThunk;i.onResetAndSelectThunk;return c.a.createElement(_,Object.assign({onMetaClick:l(t),onShiftClick:o(t)},a),n)},U=n(208),N=n(425),z=n(7),W=n.n(z),P=n(228),q=n(89),V=n(424),G=n(415),B=n(155),K=n(91),J=n(416),Q=n(124),H=n(148),X=n(426);function Y(){var e=Object(g.a)(["\n  query getAuthUser {\n    me {\n      id\n      fullName\n      email\n\n      labels {\n        id\n        name\n      }\n    }\n  }\n"]);return Y=function(){return e},e}var Z=x()(Y()),ee=c.a.createContext({}),te=localStorage.getItem("user"),ne=function(){return Object(r.useContext)(ee)};function ae(){var e=Object(g.a)(["\n  mutation createLabel($name: String!) {\n    createLabel(name: $name) {\n      # user\n      id\n\n      labels {\n        id\n        name\n      }\n    }\n  }\n"]);return ae=function(){return e},e}function re(){var e=Object(g.a)(["\n  mutation disconnectLabelFromItem($labelId: String!, $itemId: String!) {\n    disconnectLabelFromItem(labelId: $labelId, itemId: $itemId) {\n      ...ItemLabelResponseFragment\n    }\n  }\n\n  ","\n"]);return re=function(){return e},e}function ce(){var e=Object(g.a)(["\n  mutation connectLabelToItem($name: String!, $itemId: String!) {\n    connectLabelToItem(name: $name, itemId: $itemId) {\n      ...ItemLabelResponseFragment\n    }\n  }\n\n  ","\n"]);return ce=function(){return e},e}function ie(){var e=Object(g.a)(["\n  fragment ItemLabelResponseFragment on Item {\n    id\n\n    labels {\n      id\n      name\n    }\n  }\n"]);return ie=function(){return e},e}var le=x()(ie()),oe=x()(ce(),le),ue=x()(re(),le),se=x()(ae()),de=function(e){var t=e.item,n=void 0===t?null:t,a=e.canAddLabels,i=void 0===a||a,l=e.selectedLabels,o=e.onSelectedLabelChange,u=Object(r.useState)(0),s=Object(O.a)(u,2),d=s[0],m=s[1],f=Object(r.useState)([]),b=Object(O.a)(f,2),p=b[0],g=b[1],h=Object(r.useState)(!1),v=Object(O.a)(h,2),w=v[0],x=v[1],y=Object(r.useRef)(null),C=Object(U.a)(),I=C.isOpen,S=C.onOpen,L=C.onClose,A=ne(),R=A.user,$=A.refetchUser,_=!n;Object(r.useEffect)((function(){l&&g(l)}),[]),Object(r.useEffect)((function(){o&&p!==l&&o(p)}),[p&&p.length]);var F=Object(q.a)({defaultValues:{search:""}}),D=F.getValues,T=F.setValue,N=F.register,z=F.watch,Y=Object(k.b)(oe,{onCompleted:function(){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!$){e.next=3;break}return e.next=3,W.a.awrap($());case 3:T("search","");case 4:case"end":return e.stop()}}))}}),Z=Object(O.a)(Y,2),ee=Z[0],te=Z[1].loading,ae=Object(k.b)(ue),re=Object(O.a)(ae,1)[0],ce=Object(k.b)(se),ie=Object(O.a)(ce,1)[0],le=D().search,de=_?p:n.labels,me=j.a.take(R.labels.filter((function(e){var t=e.name;return!de.find((function(e){return e.name===t}))&&t.toLowerCase().includes(le.toLowerCase())})),4);z("search"),Object(r.useEffect)((function(){m(0)}),[le]),Object(r.useEffect)((function(){d>me.length-1&&m(me.length-1)}),[te]),Object(r.useEffect)((function(){I&&!w?x(!0):!I&&w&&x(!1)}),[I]);var fe=function(e){var t,a,r;return W.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(!_){c.next=12;break}if(t=R.labels.find((function(t){return t.name===e}))){c.next=8;break}return c.next=5,W.a.awrap(ie({variables:{name:e}}));case 5:a=c.sent,r=a.data,t=r.createLabel.labels.find((function(t){return t.name===e}));case 8:g([].concat(Object(E.a)(p),[t])),T("search",""),c.next=13;break;case 12:ee({variables:{name:e,itemId:n.id}});case 13:case"end":return c.stop()}}))};return c.a.createElement(V.a,{d:"flex",flexDirection:"row",alignItems:"flex-start",alignContent:"flex-start",flexWrap:"wrap"},c.a.createElement(G.a,{placement:"bottom",isOpen:I,initialFocusRef:y,onOpen:S,onClose:function(){T("search",""),m(0),L&&L()}},i&&c.a.createElement(G.d,null,c.a.createElement(B.a,{size:"xs",height:"25px",onClick:S,"aria-label":"add labels",variant:"outline",mr:2,cursor:"pointer"},c.a.createElement(M.a,{size:"10px",name:"add"}))),c.a.createElement(G.c,{zIndex:4,p:5},c.a.createElement(P.a,{returnFocus:!0,persistentFocus:!1},c.a.createElement(G.b,{bg:"white"}),c.a.createElement(V.a,{spacing:4,shouldWrapChildren:!0,onKeyDown:function(e){e.metaKey&&"Enter"===e.key&&le?fe(le):"Enter"===e.key&&me[d]&&fe(me[d].name)},onKeyUp:function(e){38===e.keyCode?m(d>0?d-1:me.length-1):40===e.keyCode&&(d<me.length-1?m(d+1):m(0))}},c.a.createElement(K.a,null,c.a.createElement(J.a,{size:"md"},c.a.createElement(Q.a,{pr:"4.5rem",placeholder:"Label",name:"search",ref:N}),c.a.createElement(H.b,{width:"4.5rem"},c.a.createElement(B.a,{size:"sm",h:"1.75rem",isLoading:te,onClick:function(){return!te&&fe(le)}},"Add")))),!!me.length&&c.a.createElement(V.a,{spacing:2},me.map((function(e,t){var n=e.name;return c.a.createElement(X.c,{size:"md",key:n,cursor:"pointer",variantColor:t===d?"cyan":"gray",onMouseOver:function(){return m(t)},onClick:function(e){e.preventDefault(),e.stopPropagation(),fe(n)}},c.a.createElement(X.a,{icon:"add",size:"6px"}),c.a.createElement(X.b,null,n))}))))))),de.map((function(e){var t=e.id,a=e.name;return c.a.createElement(X.c,{size:"md",key:a,mr:2,mb:5,cursor:"pointer",onClick:function(){return function(e){var t=e.id,a=e.name;if(_){var r=p.findIndex((function(e){return e.name===a}));g([].concat(Object(E.a)(p.slice(0,r)),Object(E.a)(p.slice(r+1))))}else re({variables:{labelId:t,itemId:n.id}})}({id:t,name:a})}},c.a.createElement(X.a,{size:"12px",icon:"delete"}),c.a.createElement(X.b,null,a))})))},me=function(e){var t=e.item,n=Object(U.a)(!1),a=n.isOpen,r=n.onOpen,i=n.onClose,l=t.file;return c.a.createElement(c.a.Fragment,null,c.a.createElement(ut,{item:t,tooltip:"Open file"},c.a.createElement(T,{onSingleClick:r,item:t},(function(e){return c.a.createElement($,Object.assign({width:ct,height:"200px",objectFit:"cover",isReady:l.isUploaded,src:l.isUploaded?l.squareUrl:"https://react.semantic-ui.com/images/wireframe/image.png"},e))})),c.a.createElement(ot,{item:t,onSingleClick:r},l.name,".",l.extension)),c.a.createElement(N.a,{size:"100vw",onClose:i,scrollBehavior:"inside",isOpen:a,closeOnEsc:!1,m:0},c.a.createElement(N.g,null),c.a.createElement(N.d,{m:0},c.a.createElement(N.f,null,l.name,".",l.extension),c.a.createElement(N.c,null),c.a.createElement(N.b,{d:"flex",justifyContent:"center",flexWrap:"wrap",alignItems:"center"},c.a.createElement($,{rounded:!0,isReady:l.isUploaded,src:l.fullUrl,height:"100%",maxWidth:"100%",p:3})),c.a.createElement(N.e,{d:"flex",justifyContent:"center"},c.a.createElement(C.a,{m:3},c.a.createElement(de,{item:t}))))))},fe=function(e){var t=e.item,n=t.link,a=new URL(n.href);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ut,{item:t,tooltip:"Visit ".concat(a.hostname)},c.a.createElement(T,{onSingleClick:function(){return window.open(n.href)},item:t},(function(e){return c.a.createElement($,Object.assign({src:n.image,width:ct,height:"200px",objectFit:"cover",placeholderIcon:"external-link"},e))}))),c.a.createElement(ot,{item:t,onSingleClick:function(){return window.open(n.href)}},c.a.createElement(M.a,{name:"link",fontSize:"s",mr:2})," ",n.title||n.href))},be=n(221),pe=n(417),ge=n(418);function he(){var e=Object(g.a)(["\n  mutation updateNote($noteId: String!, $raw: String!, $text: String!) {\n    updateNote(noteId: $noteId, raw: $raw, text: $text) {\n      ...NoteFull\n    }\n  }\n\n  ","\n"]);return he=function(){return e},e}function Ee(){var e=Object(g.a)(["\n  mutation createNote($raw: String!, $text: String!) {\n    createNote(raw: $raw, text: $text) {\n      ...NoteFull\n    }\n  }\n\n  ","\n"]);return Ee=function(){return e},e}function Oe(){var e=Object(g.a)(["\n  fragment NoteFull on Note {\n    id\n\n    raw\n    text\n\n    createdAt\n    updatedAt\n\n    item {\n      id\n      type\n\n      labels {\n        id\n        name\n      }\n    }\n  }\n"]);return Oe=function(){return e},e}var ve=x()(Oe()),je=x()(Ee(),ve),ke=x()(he(),ve),we=n(3),xe=n(215),ye=n.n(xe),Ce=n(13),Ie=n(34),Se=n.n(Ie),Le=n(102),Ae=n(231);function Me(){var e=Object(g.a)(["\n      font-family: monospace;\n      background-color: #eee;\n      padding: 3px;\n    "]);return Me=function(){return e},e}function Re(){var e=Object(g.a)(["\n      display: inline-block;\n      border-left: 2px solid #ddd;\n      padding-left: 10px;\n      color: #aaa;\n      font-style: italic;\n    "]);return Re=function(){return e},e}function $e(){var e=Object(g.a)(["\n      display: block;\n      text-align: center;\n      border-bottom: 2px solid #ddd;\n    "]);return $e=function(){return e},e}function _e(){var e=Object(g.a)(["\n      padding-left: 10px;\n      font-size: 20px;\n      line-height: 10px;\n    "]);return _e=function(){return e},e}function Fe(){var e=Object(g.a)(["\n      display: inline-block;\n      font-weight: bold;\n      font-size: 20px;\n      margin: 20px 0 10px 0;\n    "]);return Fe=function(){return e},e}function De(){var e=Object(g.a)(["\n  font-size: 16px;\n  font-weight: ",";\n  font-style: ",";\n  text-decoration: ",";\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return De=function(){return e},e}Se.a.languages.markdown=Se.a.languages.extend("markup",{}),Se.a.languages.insertBefore("markdown","prolog",{blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},code:[{pattern:/^(?: {4}|\t).+/m,alias:"keyword"},{pattern:/``.+?``|`[^`\n]+`/,alias:"keyword"}],title:[{pattern:/\w+.*(?:\r?\n|\r)(?:==+|--+)/,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#+.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])([\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:/(^|[^\\])(\*\*|__)(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^\*\*|^__|\*\*$|__$/}},italic:{pattern:/(^|[^\\])([*_])(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^[*_]|[*_]$/}},url:{pattern:/!?\[[^\]]+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)| ?\[[^\]\n]*\])/,inside:{variable:{pattern:/(!?\[)[^\]]+(?=\]$)/,lookbehind:!0},string:{pattern:/"(?:\\.|[^"\\])*"(?=\)$)/}}}}),Se.a.languages.markdown.bold.inside.url=Se.a.util.clone(Se.a.languages.markdown.url),Se.a.languages.markdown.italic.inside.url=Se.a.util.clone(Se.a.languages.markdown.url),Se.a.languages.markdown.bold.inside.italic=Se.a.util.clone(Se.a.languages.markdown.italic),Se.a.languages.markdown.italic.inside.bold=Se.a.util.clone(Se.a.languages.markdown.bold);var Te=[{children:[{text:"Slate is flexible enough to add **decorations** that can format text based on its content. For example, this editor has **Markdown** preview decorations on it, to make it _dead_ simple to make an editor with built-in Markdown previewing."}]},{children:[{text:"## Try it out!"}]},{children:[{text:"Try it out for yourself!"}]}],Ue=h.b.span(De(),(function(e){return e.leaf.bold&&"bold"}),(function(e){return e.leaf.italic&&"italic"}),(function(e){return e.leaf.underlined&&"underline"}),(function(e){return e.leaf.title&&Object(h.a)(Fe())}),(function(e){return e.leaf.list&&Object(h.a)(_e())}),(function(e){return e.leaf.hr&&Object(h.a)($e())}),(function(e){return e.leaf.blockquote&&Object(h.a)(Re())}),(function(e){return e.leaf.code&&Object(h.a)(Me())})),Ne=function(e){var t=e.attributes,n=e.children,a=e.leaf;return c.a.createElement(Ue,Object.assign({},t,{leaf:a}),n)},ze=c.a.memo((function(e){var t=e.value,n=void 0===t?Te:t,a=e.onChange,i=Object(r.useMemo)((function(){return Object(Ae.a)(Object(Le.d)(Object(we.i)()))}),[]),l=(c.a.useRef(null),Object(r.useCallback)((function(e){return c.a.createElement(Ne,e)}),[])),o=Object(r.useCallback)((function(e){var t=Object(O.a)(e,2),n=t[0],a=t[1],r=[];if(!we.g.isText(n))return r;var c=function e(t){return"string"===typeof t?t.length:"string"===typeof t.content?t.content.length:t.content.reduce((function(t,n){return t+e(n)}),0)},i=Se.a.tokenize(n.text,Se.a.languages.markdown),l=0,o=!0,u=!1,s=void 0;try{for(var d,m=i[Symbol.iterator]();!(o=(d=m.next()).done);o=!0){var f,b=d.value,p=l+c(b);if("string"!==typeof b)r.push((f={},Object(Ce.a)(f,b.type,!0),Object(Ce.a)(f,"anchor",{path:a,offset:l}),Object(Ce.a)(f,"focus",{path:a,offset:p}),f));l=p}}catch(g){u=!0,s=g}finally{try{o||null==m.return||m.return()}finally{if(u)throw s}}return r}),[]);return Object(r.useEffect)((function(){Le.b.focus(i)}),[]),c.a.createElement(C.a,null,c.a.createElement(Le.c,{autoFocus:!0,editor:i,value:n,onChange:a},c.a.createElement(Le.a,{decorate:o,renderLeaf:l,placeholder:"Write a note..."})))}));function We(){var e=Object(g.a)(["\n  mutation deleteItem($itemId: String!) {\n    deleteItem(itemId: $itemId) {\n      # user\n      id\n    }\n  }\n"]);return We=function(){return e},e}function Pe(){var e=Object(g.a)(["\n  fragment ItemWithLabels on Item {\n    id\n    type\n\n    labels {\n      id\n      name\n    }\n  }\n"]);return Pe=function(){return e},e}function qe(){var e=Object(g.a)(["\n  fragment ItemFull on Item {\n    id\n    type\n\n    createdAt\n    updatedAt\n\n    labels {\n      id\n      name\n    }\n\n    link {\n      id\n      href\n      notes\n\n      image\n      favicon\n      title\n      description\n    }\n\n    file {\n      id\n      name\n      extension\n      isUploaded\n      fullUrl\n      squareUrl\n    }\n\n    note {\n      ...NoteFull\n    }\n  }\n\n  ","\n"]);return qe=function(){return e},e}var Ve,Ge,Be=x()(qe(),ve),Ke=(x()(Pe()),x()(We())),Je=function(e){return Object(k.b)(Ke,{variables:{itemId:e.id},optimisticResponse:{__typename:"Mutation",deleteItem:{id:"1234",__typename:"Item"}},update:function(t){var n,a;return W.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.readQuery({query:Nt}),a=n.items.filter((function(t){return t.id!==e.id})),r.next=4,W.a.awrap(t.writeQuery({query:Nt,data:{items:a}}));case 4:case"end":return r.stop()}}))}})},Qe=function(e){return e.map((function(e){return we.c.string(e)})).join("\n")},He=[{children:[{text:"",marks:[]}]}],Xe=(Qe(He),function(e){var t=e.note,n=Object(q.a)({defaultValues:{value:JSON.parse(t.raw)}}),a=n.getValues,i=n.watch,l=n.setValue,o=n.register,u=a().value,s=Object(r.useRef)(Qe(u)),d=Object(k.b)(ke,{variables:{noteId:t.id,raw:JSON.stringify(u),text:ye()(s.current)}}),m=Object(O.a)(d,1)[0],f=Object(r.useRef)(j.a.debounce(m,500)).current,b=Je(t.item),p=Object(O.a)(b,1)[0];return i("value"),Object(r.useEffect)((function(){o({name:"value"})}),[o]),Object(r.useEffect)((function(){var e=Qe(u);e!==s.current&&f(u),s.current=e}),[u]),Object(r.useEffect)((function(){return function(){f.cancel(),s.current||p()}}),[]),c.a.createElement(ze,{value:u,onChange:function(e){l("value",e)}})}),Ye=n(152),Ze=n.n(Ye),et=function(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e})),t.current},tt={},nt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.isGlobal,i=void 0!==a&&a,l=n.shouldBind,o=void 0===l||l;n.ref;Object(r.useEffect)((function(){(function(e){var t=e.prototype.stopCallback;e.prototype.stopCallback=function(e,n,a,r){return!!this.paused||!tt[a]&&!tt[r]&&t.call(this,e,n,a)},e.prototype.bindGlobal=function(e,t,n){if(this.bind(e,t,n),e instanceof Array)for(var a=0;a<e.length;a++)tt[e[a]]=!0;else tt[e]=!0},e.init()})(Ze.a)}),[]);var u=c.a.useCallback((function(e){e.preventDefault&&e.preventDefault(),t()}),[t]),s=c.a.useRef(Ze.a),d=s.current,m=et(o),f=function(){d[i?"bindGlobal":"bind"](e,u)},b=function(){d.unbind(e)};Object(r.useEffect)((function(){return function(){b()}}),[]),Object(r.useEffect)((function(){o?f():!o&&m&&b()}),[o])},at=function(e){var t=e.item,n=e.children,a=Object(r.useState)(!1),i=Object(O.a)(a,2),l=i[0],o=i[1],u=function(){return o(!0)},s=function(){return o(!1)},d=Object(k.a)();nt("c n",(function(){g||o(!0)}));var m=Object(k.b)(je,{variables:{raw:JSON.stringify(He),text:Qe(He)},refetchQueries:["feed"]}),f=Object(O.a)(m,2),b=f[0],p=f[1].data;Object(r.useEffect)((function(){l&&!t&&b()}),[l]);var g=t&&t.note?t.note:p&&d.readFragment({id:p.createNote.id,fragment:ve});return c.a.createElement(c.a.Fragment,null,n?n({isOpen:l,open:u,close:s}):c.a.createElement(pe.a,{hasArrow:!0,placement:"bottom",label:"or press c + n","aria-label":"Add note"},c.a.createElement(B.a,{variant:"solid",cursor:"pointer",onClick:u},c.a.createElement(M.a,{name:"plus-square"}))),c.a.createElement(N.a,{size:"full",scrollBehavior:"inside",isOpen:l,onClose:s,closeOnEsc:!1},c.a.createElement(N.g,null),c.a.createElement(N.d,{height:700,width:700},c.a.createElement(N.f,null),c.a.createElement(N.c,null),c.a.createElement(N.b,null,c.a.createElement(C.a,{p:5,height:"100%"},g?c.a.createElement(Xe,{note:g}):c.a.createElement(C.a,{d:"flex",justifyContent:"center"},c.a.createElement(I.a,null)))),g&&c.a.createElement(N.e,{justifyContent:"flex-start"},c.a.createElement(C.a,{mt:10},c.a.createElement(de,{item:g.item}))))))},rt=function(e){var t=e.item,n=t.note;return c.a.createElement(at,{item:t},(function(e){var a=e.open;return c.a.createElement(T,{onSingleClick:a,item:t},(function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement(ut,Object.assign({border:"1px solid black",rounded:"lg",p:5,overflow:"hidden",tooltip:"Open note",item:t},e),c.a.createElement(be.a,{fontSize:"xs"},n.text)),c.a.createElement(ot,{item:t},n.text))}))}))},ct=270,it=ct+5,lt=function(e){var t=e.item,n=null,a=Object(r.useContext)(F).isItemSelected;switch(t.type){case"file":n=t.file?c.a.createElement(me,{item:t}):null;break;case"note":n=t.note&&t.note.text?c.a.createElement(rt,{item:t}):null;break;case"link":n=t.link?c.a.createElement(fe,{item:t}):null;break;default:n=null}return n?c.a.createElement(C.a,{d:"flex",justifyContent:"center",margin:0,width:ct,maxWidth:ct,height:315,padding:"".concat(5,"px")},c.a.createElement(V.a,{p:"4"},c.a.createElement(C.a,null,a(t)&&!1,n))):null},ot=function(e){var t=e.children,n=e.item,a=Object(L.a)(e,["children","item"]);return c.a.createElement(_,a,(function(e){return c.a.createElement(C.a,Object.assign({},e,{mt:4,ml:1}),c.a.createElement(be.a,{maxWidth:ct,fontSize:"lg",fontWeight:"bold",whiteSpace:"nowrap",overflow:"hidden",style:{textOverflow:"ellipsis"},mb:3},t),c.a.createElement(be.a,null,Object(A.a)(new Date(n.createdAt),new Date)))}))},ut=function(e){var t=e.children,n=e.tooltip,a=e.item,r=Object(L.a)(e,["children","tooltip","item"]),i=Object(U.a)(),l=Object(U.a)(),o=c.a.useRef(null),u=Je(a),s=Object(O.a)(u,1)[0];return nt("d",(function(){i.isOpen&&s()}),{ref:o.current,shouldBind:i.isOpen}),c.a.createElement(pe.a,{hasArrow:!0,label:n,"aria-label":n,placement:"top",maxWidth:200,isOpen:i.isOpen&&!l.isOpen,onOpen:i.onOpen},c.a.createElement(C.a,{onMouseEnter:i.onOpen,onMouseLeave:i.onClose,position:"relative"},i.isOpen&&c.a.createElement(C.a,{d:"flex",justifyContent:"flex-end",p:2,alignItems:"center",roundedBottomRight:"lg",roundedBottomLeft:"lg",position:"absolute",bottom:0,height:10,width:ct,zIndex:10,backgroundColor:"lightgrey",background:"rgb(211,211,211, 0.8);",opacity:9,onMouseOver:l.onOpen,onMouseLeave:l.onClose},c.a.createElement(pe.a,{hasArrow:!0,label:"press d while hovering over the item","aria-label":"delete item",placement:"bottom"},c.a.createElement(ge.a,{size:"sm",icon:"delete",cursor:"pointer","aria-label":"delete item",onClick:function(){return s()}}))),c.a.createElement(C.a,Object.assign({width:ct,height:200,ref:o},r),t)))},st=n(233),dt=n(229),mt=function(e){var t=e.onPaste,n=Object(r.useRef)((function(e){t&&t(e)}));Object(r.useEffect)((function(){return document.getElementsByTagName("body")[0].addEventListener("paste",n.current),function(){document.getElementsByTagName("body")[0].removeEventListener("paste",n.current)}}),[])},ft=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},bt=function(e){var t=e.search,n=e.labels,a=e.type,r={};return j.a.set(r,"search",t),j.a.set(r,"type","all"!==a?a:null),j.a.set(r,"where.labels.".concat(n.length?"some":"none",".id.in"),n.map((function(e){return e.id}))),console.log(r),r};!function(e){e[e.CREATE_FILES_MODAL=0]="CREATE_FILES_MODAL",e[e.CREATE_LINK_MODAL=1]="CREATE_LINK_MODAL",e[e.CREATE_NOTE_MODAL=2]="CREATE_NOTE_MODAL",e[e.FILTER_FEED_MODAL=3]="FILTER_FEED_MODAL",e[e.VIEW_FILE_MODAL=4]="VIEW_FILE_MODAL"}(Ge||(Ge={}));var pt=c.a.createContext({}),gt=(Ve={},Object(Ce.a)(Ve,Ge.CREATE_FILES_MODAL,!1),Object(Ce.a)(Ve,Ge.CREATE_LINK_MODAL,!1),Object(Ce.a)(Ve,Ge.CREATE_NOTE_MODAL,!1),Object(Ce.a)(Ve,Ge.FILTER_FEED_MODAL,!1),Object(Ce.a)(Ve,Ge.VIEW_FILE_MODAL,!1),Ve),ht=function(e){var t=c.a.useContext(pt),n=t.openModal,a=t.closeModal,r=t.toggleModal,i=t.globalModalState;return{closeAll:t.closeAll,openModal:function(){return n(e)},closeModal:function(){return a(e)},toggleModal:function(){return r(e)},isModalOpen:i[e]}};function Et(){var e=Object(g.a)(["\n  mutation generateSignedUrls($signedURLArgs: [SignedURLArgs!]) {\n    generateSignedUrls(signedURLArgs: $signedURLArgs) {\n      signedUrls\n      uploadGroup {\n        id\n      }\n    }\n  }\n"]);return Et=function(){return e},e}function Ot(){var e=Object(g.a)(["\n  mutation processFiles($uploadGroupId: String) {\n    processFiles(uploadGroupId: $uploadGroupId) {\n      id\n      squareUrl\n      fullUrl\n    }\n  }\n"]);return Ot=function(){return e},e}var vt=x()(Ot()),jt=x()(Et()),kt=function(){var e=Object(r.useState)({}),t=Object(O.a)(e,2),n=t[0],i=t[1],l=Object(r.useState)(!1),o=Object(O.a)(l,2),u=o[0],s=o[1],d=ht(Ge.CREATE_FILES_MODAL),m=d.isModalOpen,f=d.openModal,b=d.toggleModal,p=d.closeModal;nt("c f",b);var g=Object.keys(n).length,h=Object.values(n),E=Object.entries(n),v=Object(k.b)(vt,{refetchQueries:["feed"]}),j=Object(O.a)(v,2),w=j[0],x=j[1].loading,y=u||x,I=Object(k.b)(jt),S=Object(O.a)(I,1)[0];Object(r.useEffect)((function(){!function(){var e,t,n,a,r;W.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(!u){c.next=21;break}return e=h.map((function(e){return"temp/".concat(e.id,"-").concat(e.name)})),c.prev=2,c.next=5,W.a.awrap(S({variables:{signedURLArgs:h.map((function(t,n){var a=t.type;return{name:t.name,key:e[n],type:a}}))}}));case 5:return t=c.sent,n=t.data.generateSignedUrls,a=n.signedUrls,r=n.uploadGroup,c.next=11,W.a.awrap(Promise.all(a.map((function(t,n){var a,r;return W.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return a=h[n],r=e[n],c.next=4,W.a.awrap(fetch(t,{method:"PUT",body:a,headers:{"Access-Control-Allow-Headers":"Content-Type","Content-Type":a.type}}));case 4:return c.abrupt("return",{tempKey:r,originalFilename:a.name});case 5:case"end":return c.stop()}}))}))));case 11:return s(!1),p(),i({}),c.next=16,W.a.awrap(w({variables:{uploadGroupId:r.id}}));case 16:c.next=21;break;case 18:c.prev=18,c.t0=c.catch(2),s(!1);case 21:case"end":return c.stop()}}),null,null,[[2,18]])}()}),[u]),Object(r.useEffect)((function(){if(y){var e=function(e){e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}}}),[y]);var A=Object(r.useCallback)((function(e){i(Object(a.a)({},n,{},e.reduce((function(e,t){var n=ft();return t.id=n,Object(a.a)({},e,Object(Ce.a)({},n,t))}),{})))}),[n]);mt({onPaste:function(e){var t,r,c,l,o;return W.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:for(t=e.clipboardData.items,r=0;r<t.length;r++)c=e.clipboardData.items[r],(l=c.getAsFile())&&(o=ft(),l.id=o,i(Object(a.a)({},n,Object(Ce.a)({},o,l))));case 2:case"end":return u.stop()}}))}});var $=Object(dt.a)({onDrop:A}),_=$.getRootProps,F=$.getInputProps;return c.a.createElement(c.a.Fragment,null,c.a.createElement(pe.a,{hasArrow:!0,placement:"bottom",label:"or press c + f","aria-label":"Add file(s)"},c.a.createElement(B.a,{cursor:"pointer",variant:"solid",onClick:f},c.a.createElement(M.a,{name:"attachment"}))),c.a.createElement(N.a,{closeOnEsc:!1,size:"600px",isOpen:m,scrollBehavior:"inside",onClose:function(){p(),i({})}},c.a.createElement(N.g,null),c.a.createElement(N.d,{height:"80%"},c.a.createElement(N.f,null,"Upload files"),c.a.createElement(N.c,null),c.a.createElement(N.b,_(),c.a.createElement("input",F()),!!g&&c.a.createElement(C.a,{d:"block"},E.map((function(e){var t=Object(O.a)(e,2),a=t[0],r=t[1];return c.a.createElement(C.a,{key:a,width:"100%",d:"flex",mb:15,justifyContent:"space-between"},c.a.createElement(C.a,{d:"flex",alignItems:"center",width:"50%"},c.a.createElement(R.a,{key:r.path,src:"https://react.semantic-ui.com/images/wireframe/image.png",objectFit:"cover",size:"40px",mr:"15px",rounded:"lg"}),c.a.createElement(be.a,null,r.name)),c.a.createElement(C.a,{d:"flex",verticalAlign:"middle"},!y&&c.a.createElement(B.a,{onClick:function(e){e.preventDefault(),e.stopPropagation();var t=r.id,a=(n[t],Object(L.a)(n,[t].map(st.a)));i(a)}},"Remove")))}))),!g&&c.a.createElement(C.a,null,c.a.createElement(be.a,null,"Click, drag, or paste here"))),c.a.createElement(N.e,null,c.a.createElement(B.a,{isLoading:y,isDisabled:!g,onClick:function(){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:s(!0);case 1:case"end":return e.stop()}}))},color:g?"green":"yellow"},c.a.createElement(C.a,{alignItems:"center"},c.a.createElement(M.a,{name:"add"})," ",g?"Add":"Waiting for images..."))))))},wt=n(153);function xt(){var e=Object(g.a)(["\n  mutation createLink($href: String!) {\n    createLink(href: $href) {\n      id\n      href\n    }\n  }\n"]);return xt=function(){return e},e}var yt=wt.object().shape({href:wt.string().url("Invalid URL").required("Required")}),Ct=x()(xt()),It=function(){var e=Object(q.a)({validationSchema:yt,mode:"onBlur"}),t=e.getValues,n=e.setValue,a=e.handleSubmit,r=e.watch,i=e.register,l=e.errors;r("href");var o=t().href,u=ht(Ge.CREATE_LINK_MODAL),s=u.isModalOpen,d=u.openModal,m=u.toggleModal,f=u.closeModal;nt("c l",m);var b=Object(k.b)(Ct,{variables:{href:o},refetchQueries:["feed"],onCompleted:function(){return E()}}),p=Object(O.a)(b,2),g=p[0],h=p[1].loading;mt({onPaste:function(e){var t=(e.originalEvent||e).clipboardData.getData("text/plain");t&&n("href",t)}});var E=function(){f(),n("href","")};return c.a.createElement(c.a.Fragment,null,c.a.createElement(pe.a,{hasArrow:!0,placement:"bottom",label:"or press c + l","aria-label":"Add link"},c.a.createElement(B.a,{cursor:"pointer",variant:"solid",onClick:d},c.a.createElement(M.a,{name:"link"}))),c.a.createElement(N.a,{onClose:E,scrollBehavior:"inside",closeOnEsc:!1,isOpen:s},c.a.createElement(N.g,null),c.a.createElement(N.d,{height:"250px"},c.a.createElement(N.f,null,"Paste link"),c.a.createElement(N.c,null),c.a.createElement(N.b,null,c.a.createElement("form",{onSubmit:a((function(){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.a.awrap(g());case 2:case"end":return e.stop()}}))}))},c.a.createElement(C.a,{display:"none"},c.a.createElement("input",{name:"href",defaultValue:"",ref:i}),l.href&&c.a.createElement(be.a,{color:"red"},l.href.message)),o&&c.a.createElement(C.a,{width:"100%"},c.a.createElement("a",{href:o,target:"_blank"},o)))),c.a.createElement(N.e,null,c.a.createElement(B.a,{isLoading:h,isDisabled:!o,onClick:function(){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=3;break}return e.next=3,W.a.awrap(g());case 3:case"end":return e.stop()}}))},color:o?"green":"yellow"},c.a.createElement(C.a,{alignItems:"center"},c.a.createElement(M.a,{name:"add"})," ",o?"Add":"Waiting for link..."))))))},St=function(){var e=ne();return c.a.createElement(B.a,{cursor:"pointer",onClick:function(){e.signOut&&e.signOut()}},"Sign out")};function Lt(){var e=Object(g.a)(["\n  query getUploadGroups {\n    uploadGroups {\n      id\n      isComplete\n\n      files {\n        id\n        name\n        extension\n        isUploaded\n      }\n    }\n  }\n"]);return Lt=function(){return e},e}x()(Lt());var At=function(){return null},Mt=n(419),Rt=n(420),$t=n(423),_t={search:"",labels:[],type:"all"},Ft=function(e){var t=e.filter,n=e.variables,i=Object(r.useState)(_t),l=Object(O.a)(i,2),o=l[0],u=l[1],s=ne().user,d=ht(Ge.FILTER_FEED_MODAL),m=d.isModalOpen,f=d.openModal,b=d.closeModal,p=d.toggleModal;nt("command command",p,{isGlobal:!0});var g=function(e,t){var n=j.a.get(e,"where.labels.some.id.in",[]);return{search:e.search,type:e.type||"all",labels:n.map((function(e){return t.labels.find((function(t){return t.id===e}))}))}}(n,s),h=o.search,E=o.labels,v=o.type;return Object(r.useEffect)((function(){m&&u(g)}),[m]),c.a.createElement(c.a.Fragment,null,c.a.createElement(pe.a,{hasArrow:!0,placement:"bottom",label:"or press \u2318 + \u2318","aria-label":"Filter feed"},c.a.createElement(B.a,{cursor:"pointer",leftIcon:"search",variant:"outline",onClick:f},"Filter")),c.a.createElement(N.a,{isCentered:!0,isOpen:m,onClose:b,closeOnEsc:!0,closeOnOverlayClick:!0},c.a.createElement(N.g,null),c.a.createElement(N.d,{rounded:"lg"},c.a.createElement(N.b,null,c.a.createElement(C.a,{p:5},c.a.createElement(K.a,{mb:5},c.a.createElement(Mt.a,null,"Search"),c.a.createElement(Q.a,{name:"search",defaultValue:"",value:o.search,onChange:function(e){u(Object(a.a)({},o,{search:e.target.value}))}}),c.a.createElement(Rt.a,{id:"email-helper-text"},"Note content, file name, URL domain, etc.")),c.a.createElement(K.a,{mb:5},c.a.createElement(Mt.a,null,"Type"),c.a.createElement($t.a,{placeholder:"Select type",value:o.type,onChange:function(e){u(Object(a.a)({},o,{type:e.target.value}))}},[["all","All"],["link","Links"],["file","Files"],["note","Notes"]].map((function(e){var t=Object(O.a)(e,2),n=t[0],a=t[1];return c.a.createElement("option",{value:n},a)}))),c.a.createElement(Rt.a,{id:"email-helper-text"},"File, link, note")),c.a.createElement(K.a,null,c.a.createElement(Mt.a,null,"Labels"),c.a.createElement(de,{selectedLabels:g.labels,onSelectedLabelChange:function(e){u(Object(a.a)({},o,{labels:e}))}})))),c.a.createElement(N.e,null,c.a.createElement(B.a,{variant:"outline",color:"green",cursor:"pointer",mr:3,onClick:function(){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.a.awrap(t(bt(_t)));case 2:b();case 3:case"end":return e.stop()}}))}},"Reset"),c.a.createElement(B.a,{color:"green",cursor:"pointer",onClick:function(){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.a.awrap(t(bt({labels:E,search:h,type:v})));case 2:b();case 3:case"end":return e.stop()}}))}},"Apply")))))};function Dt(){var e=Object(g.a)(["\n  justify-self: center;\n\n  @media (max-width: 400px) {\n    width: 100%;\n    /* max-width: inherit; */\n  }\n"]);return Dt=function(){return e},e}function Tt(){var e=Object(g.a)([""]);return Tt=function(){return e},e}function Ut(){var e=Object(g.a)(['\n  query feed(\n    $first: Int\n    $skip: Int\n    $search: String\n    $type: ItemType\n    $where: ItemWhereInput\n  ) {\n    items(\n      first: $first\n      skip: $skip\n      where: $where\n      search: $search\n      type: $type\n      orderBy: { createdAt: desc }\n    ) @connection(key: "feed_items") {\n      ...ItemFull\n    }\n  }\n\n  ',"\n"]);return Ut=function(){return e},e}var Nt=x()(Ut(),Be),zt=(h.b.div(Tt()),h.b.div(Dt())),Wt=function(e){e.rowLength;var t=Object(r.useState)(!1),n=Object(O.a)(t,2),i=n[0],l=n[1],o=Object(r.useState)(1),u=Object(O.a)(o,2),s=u[0],d=u[1],m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageLength:20},t=e.pageLength,n=Object(r.useState)(0),a=Object(O.a)(n,2),c=a[0],i=a[1];return{paginationVariables:{skip:c*t,first:t},setPageNum:i,nextPage:function(){return i(c+1)},prevPage:function(){return i(c-1)}}}({pageLength:30}).paginationVariables,f=Object(k.c)(Nt,{variables:m,notifyOnNetworkStatusChange:!0}),b=f.loading,p=f.data,g=f.networkStatus,h=f.refetch,v=f.fetchMore,w=f.variables,x=Object(y.a)(f);Object(r.useEffect)((function(){var e,t;p&&x.data&&((null===(e=j.a.last(p.items))||void 0===e?void 0:e.id)===(null===(t=j.a.last(x.data.items))||void 0===t?void 0:t.id)?l(!0):0===s&&l(!1),p.items.length>x.data.items.length?d(s+1):p.items.length<x.data.items.length&&0!==s&&d(0))}),[p]);var L=b&&!p;return c.a.createElement(c.a.Fragment,null,c.a.createElement(At,null),c.a.createElement(D,{items:(null===p||void 0===p?void 0:p.items)||[]},c.a.createElement(C.a,{d:"flex",justifyContent:"center"},c.a.createElement(C.a,{width:"90%",padding:50},c.a.createElement(C.a,{height:80,d:"flex",minWidth:"100%",justifyContent:"space-between",alignItems:"center"},c.a.createElement(C.a,{d:"flex",width:"150px",justifyContent:"space-between",alignItems:"center"},c.a.createElement(kt,null),c.a.createElement(It,null),c.a.createElement(at,null)),c.a.createElement(Ft,{filter:function(e){return h(Object(a.a)({},m,{},e))},variables:w}),c.a.createElement(St,null)),c.a.createElement("br",null),L?c.a.createElement(C.a,{d:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},c.a.createElement(I.a,{size:"xl"})):c.a.createElement(C.a,{d:"grid",top:-80,justifyContent:"space-between",flexWrap:"wrap",gridColumnGap:5,gridRowGap:5,gridTemplateColumns:"".concat(it,"px ").concat(it,"px ").concat(it,"px ").concat(it,"px")},((null===p||void 0===p?void 0:p.items)||[]).reduce((function(e,t){return"note"!==t.type||t.note.text?[].concat(Object(E.a)(e),[c.a.createElement(zt,{key:t.id},c.a.createElement(lt,{item:t}))]):e}),[]),7===g&&!b&&!i&&c.a.createElement(S.a,{bottomOffset:-400,onEnter:function(){v({variables:Object(a.a)({},w,{skip:30*s}),updateQuery:function(e,t){var n=t.fetchMoreResult;return n?Object(a.a)({},e,{items:[].concat(Object(E.a)(e.items||[]),Object(E.a)(n.items||[]))}):e}})}}))))))};function Pt(){var e=Object(g.a)(["\n  height: 100vh;\n"]);return Pt=function(){return e},e}var qt=h.b.div(Pt()),Vt=function(){return c.a.createElement(qt,null,c.a.createElement(Wt,null))};function Gt(){var e=Object(g.a)(["\n  query mostRecentItem($type: String) {\n    mostRecentItem(type: $type) {\n      id\n      type\n\n      labels {\n        id\n        name\n      }\n\n      link {\n        id\n        href\n        notes\n\n        image\n        favicon\n        title\n        description\n      }\n\n      file {\n        id\n        name\n        extension\n        isUploaded\n        fullUrl\n        squareUrl\n      }\n    }\n  }\n"]);return Gt=function(){return e},e}var Bt=x()(Gt()),Kt=function(){(function(){var e=Object(k.c)(Bt,{variables:{type:"link"},notifyOnNetworkStatusChange:!0}),t=e.loading,n=e.data;return{loading:t,data:n,item:!t&&n?n.mostRecentItem:null}})().item;return c.a.createElement(C.a,{display:"flex",justifyContent:"center",alignItems:"center"},c.a.createElement(C.a,{d:"flex",margin:20,padding:20,size:400,width:600,rounded:"lg",justifyContent:"center"},c.a.createElement(de,null)))},Jt=n(223),Qt=n.n(Jt);function Ht(){var e=Object(g.a)(["\n  mutation googleSignIn($code: String!) {\n    googleSignIn(code: $code) {\n      token\n    }\n  }\n"]);return Ht=function(){return e},e}var Xt=x()(Ht()),Yt=function(e){var t=e.location,n=e.devMode,a=void 0===n||n,i=ne(),l=i.setToken,o=i.user,u=Qt.a.parse(t.search),s=Object(k.b)(Xt,{variables:{code:u.code},onCompleted:function(e){e&&e.googleSignIn.token&&l&&l(e.googleSignIn.token)},onError:function(e){console.log("error!",e)}}),d=Object(O.a)(s,1)[0];return Object(r.useEffect)((function(){a&&d()}),[]),o?c.a.createElement(p.a,{to:"/"}):null};function Zt(){var e=Object(g.a)(["\n  query getGoogleUrl {\n    googleURL\n  }\n"]);return Zt=function(){return e},e}var en=x()(Zt()),tn=function(){var e=Object(k.c)(en).data;return Object(r.useEffect)((function(){e&&window.location.replace(e.googleURL)}),[e]),c.a.createElement(C.a,{display:"flex",justifyContent:"center",alignItems:"center",width:"100vw",height:"100vh"},c.a.createElement(I.a,{size:"xl"}))},nn=n(422),an=Object(a.a)({},nn.a,{colors:Object(a.a)({},nn.a.colors,{lightgrey:"#f6f8fa"})}),rn=Object(s.a)((function(e,t){var n=t.headers,r=localStorage.getItem("token");return{headers:Object(a.a)({},n,{authorization:r?"JWT ".concat(r):""})}})),cn=new d.a({dataIdFromObject:function(e){return e.id}}),ln=rn.concat(Object(u.createUploadLink)({uri:"/graphql"})),on=new o.a({link:ln,cache:cn}),un=c.a.createElement(m.a,{client:on},c.a.createElement((function(e){var t=e.children,n=Object(k.c)(Z,{fetchPolicy:"network-only"}),a=n.data,i=n.loading,l=n.refetch,o=Object(r.useState)(localStorage.getItem("token")),u=Object(O.a)(o,2),s=u[0],d=u[1];return Object(r.useEffect)((function(){s?(localStorage.setItem("token",s),a&&!a.me||l()):i||localStorage.removeItem("token")}),[s]),Object(r.useEffect)((function(){a&&a.me?localStorage.setItem("user",JSON.stringify(a.me)):i||(localStorage.removeItem("user"),localStorage.removeItem("token"))}),[i]),c.a.createElement(ee.Provider,{value:{user:a?a.me:te?JSON.parse(te):null,token:s,setToken:d,refetchUser:l,signOut:function(){localStorage.removeItem("user"),localStorage.removeItem("token"),window.location.replace("/")}}},t)}),null,c.a.createElement((function(e){var t=e.children,n=c.a.useState(gt),r=Object(O.a)(n,2),i=r[0],l=r[1],o=function(e,t){return l(Object(a.a)({},gt,Object(Ce.a)({},e,t)))};return c.a.createElement(pt.Provider,{value:{globalModalState:i,openModal:function(e){return o(e,!0)},closeModal:function(e){return o(e,!1)},toggleModal:function(e){return l((function(t){return Object(a.a)({},gt,Object(Ce.a)({},e,!t[e]))}))},closeAll:function(){return l(Object.keys(i).reduce((function(e,t){return Object(a.a)({},e,Object(Ce.a)({},t,!1))}),{}))}}},t)}),null,c.a.createElement(f.a,{theme:an},c.a.createElement((function(){var e=ne().user?Vt:tn;return c.a.createElement(b.a,null,c.a.createElement(p.d,null,c.a.createElement(p.b,{path:"/",exact:!0,component:e}),c.a.createElement(p.b,{path:"/note/:id",exact:!0,component:Xe}),c.a.createElement(p.b,{path:"/google/redirect",exact:!0,component:Yt}),c.a.createElement(p.b,{path:"/playground",exact:!0,component:Kt})))}),null)))));l.a.render(un,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[235,1,2]]]);
//# sourceMappingURL=main.9759cb37.chunk.js.map